var CUSTOM_PROTOCOL_SCHEME="wvjbscheme",QUEUE_HAS_MESSAGE="__WVJB_QUEUE_MESSAGE__";!function(){var e;window.inBeeShop=function(){return window&&window.navigator&&window.navigator.userAgent&&-1!==window.navigator.userAgent.toLowerCase().indexOf("beeshop")};var n=[],i=[],a={},r={},t=1;var d={};function o(i,a){if(!window.__appHasPendingCacheUpdate__){if(a){var d="cb_"+t+++"_"+ +new Date;r[d]=a,i.callbackId=d}-1===window.navigator.userAgent.toLowerCase().indexOf("android")?(n.push(i),e.src=CUSTOM_PROTOCOL_SCHEME+"://"+QUEUE_HAS_MESSAGE):window.gabridge&&typeof window.gabridge.sendMsg === "function"&&window.gabridge.sendMsg(JSON.stringify(i))}}function s(e){var n;if(!window.__appHasPendingCacheUpdate__){try{n=JSON.parse(e)}catch(e){n={},console.warn("Bridge dispatch failed. err = "+e)}var i;if(n.responseId){if(!(i=r[n.responseId]))return;i(n.responseData),delete r[n.responseId]}else{if(n.callbackId){var t=n.callbackId;i=function(e){o({responseId:t,responseData:e})}}var d=window.WebViewJavascriptBridge._messageHandler;if(n.handlerName&&(d=a[n.handlerName]),void 0===d)return;for(var s in d)if(d.hasOwnProperty(s))try{d[s](n.data,i)}catch(e){"undefined"!=typeof console&&console.log("WebViewJavascriptBridge: WARNING: javascript handler threw.",n,e)}}}}function w(e){var n=!1;try{n=null!=a[e]}catch(e){n=!1}return n?"true":"false"}function c(e){window.gabridge&&typeof window.gabridge.onHasHandler === "function"&&window.gabridge.onHasHandler(e,w(e))}window.WebViewJavascriptBridge={init:function(e){if(window.WebViewJavascriptBridge._messageHandler)return console.warn("WebViewJavascriptBridge.init called twice"),null;window.WebViewJavascriptBridge._messageHandler=[e];var n=i;i=null,setTimeout(function(){if(n)for(var e=0;e<n.length;e++)s(n[e])},0)},send:function(e,n){o({data:e},n)},registerHandler:function(e,n,i){void 0===a[e]&&(a[e]={}),i=i||n.toString(),a[e][i]=n,c(e)},unregisterHandler:function(e,n){if(n){var i=a[e];if(i){delete i[n];var r=!1;for(var t in i)if(i.hasOwnProperty(t)){r=!0;break}r||(delete a[e],c(e))}}},callHandler:function(e,n,i){for(var a in d)if(d.hasOwnProperty(a))try{d[a](e,n)}catch(e){}if("fullScreenImage"===e&&n){var r=n.imageUrls;if(r&&r.length)try{for(var t=0;t<r.length;t++){var s=r[t];"string"!=typeof s||s.indexOf(window.ITEM_IMAGE_BASE_URL)<0||(r[t]=s.replace("/webp/","/"))}}catch(e){}}o({handlerName:e,data:n},i)},hasHandler:w,hasHandlerCB:c,addHook:function(e){var n=e.toString();d[n]||(d[n]=e)},delHook:function(e){var n=e.toString();delete d[n]},appHasHandler:function(e){return window.WebViewJavascriptBridge._appHandlers&&window.WebViewJavascriptBridge._appHandlers.indexOf(e)>=0},_fetchQueue:function(){var e=JSON.stringify(n);return n=[],e},_handleMessageFromObjC:function(e){i?i.push(e):s(e)},reset:function(){n=[],i=[],a={},r={},t=1,window.WebViewJavascriptBridge._messageHandler=null}};var l=document;!function(n){(e=n.createElement("iframe")).style.display="none",e.src=CUSTOM_PROTOCOL_SCHEME+"://"+QUEUE_HAS_MESSAGE,n&&n.documentElement&&n.documentElement.appendChild(e)}(l);var f=l.createEvent("Events");f.initEvent("WebViewJavascriptBridgeReady"),f.bridge=window.WebViewJavascriptBridge,l.dispatchEvent(f)}(),window.connectWebViewJavascriptBridge=function(e){window.WebViewJavascriptBridge?e(window.WebViewJavascriptBridge):document.addEventListener("WebViewJavascriptBridgeReady",function(){window.dismissNonShopeeBridge&&window.dismissNonShopeeBridge()||e(window.WebViewJavascriptBridge)},!1)};
